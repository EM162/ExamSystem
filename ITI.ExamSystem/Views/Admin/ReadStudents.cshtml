@model ITI.ExamSystem.Models.StudentIndexViewModel
@{
    ViewData["Title"] = "Students";
    Layout = "_Layout"; // Use the custom admin layout
}

<div class="content-container">
    <div class="welcome-section">
        <a asp-action="CreateStudent" class="createStudent">Add New Student</a>

        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Branch</th>
                    <th>Track</th>
                    <th>Intake</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var student in Model.ActiveStudents)
                {
                    <tr>
                        <td>@student.UserID</td>
                        <td>
                            @{
                                var fullName = student.User.FullName;
                                if (!string.IsNullOrEmpty(ViewBag.searchTerm))
                                {
                                    var searchTerm = ViewBag.searchTerm as string;
                                    fullName = fullName.Replace(searchTerm, $"<strong>{searchTerm}</strong>", StringComparison.OrdinalIgnoreCase);
                                }
                                @Html.Raw(fullName)
                            }
                        </td>
                        <td>@student.User.Email</td>
                        <td>@student.Branch.BranchName</td>
                        <td>@student.Track.TrackName</td>
                        <td>@student.Intake.IntakeName</td>
                        <td>
                            <a asp-action="EditStudent" asp-route-id="@student.UserID" class="btn btn-warning">Edit</a>
                            <a asp-action="DeleteStudent" asp-route-id="@student.UserID" class="btn btn-danger">Delete</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        <!-- Pagination -->
        <nav aria-label="Student pagination">
            <ul class="pagination justify-content-center">
                @for (int page = 1; page <= Model.TotalPages; page++)
                {
                    <li class="page-item @(page == Model.CurrentPage ? "active" : "")">
                        <a class="page-link" asp-action="ReadStudents" asp-route-page="@(page)">@(page)</a>
                    </li>
                }
            </ul>
        </nav>
    </div>
    <!-- Deleted Students Table -->
    @if (Model.DeletedStudents.Any())
    {
        <h4 class="mt-5">InActive Students</h4>
        <table class="table table-bordered table-striped">
            <thead class="table-secondary">
                <tr>
                    <th>ID</th>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @{foreach (var student in Model.DeletedStudents)
                    {
                        <tr>
                            <td>@student.UserID</td>
                            <td>@student.FullName</td>
                            <td>@student.Email</td>
                            <td>
                                <form asp-action="Reactivate" asp-route-id="@student.UserID" method="post" style="display:inline">
                                    <button type="submit" class="btn btn-sm btn-success">Reactivate</button>
                                </form>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    }
</div>